<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Live Freely with No Boundaries · Map</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <style>
    #map { height: 600px; width: 100%; margin: 20px 0; border: 2px solid gray; }
    body { background-color: #cadecb; }

    .navbar-brand {
      background-color: #90E0EF;
      padding: 5px 12px;
      border-radius: 5px;
      margin-right: 10px;
      color: black !important;
      text-decoration: none;
    }
    .navbar-brand:hover { color: white !important; }
  </style>
</head>

<body>
<header class="site-header">
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a class="navbar-brand" href="index.html">Home</a>
      <a class="navbar-brand" href="map2.html">Map</a>
    </div>
  </nav>
</header>

<main class="container text-center">
  <h1>Live Freely With No Boundaries</h1>
  <p>Zoom, click, explore any public / no permit required place.</p>
  <div id="map"></div>
</main>

<footer class="site-footer">
  <div class="container">
    <p>© 2025 Sydney's site for GEOG 464.</p>
  </div>
</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
// ------------------------------------------------------------
// MAP SETUP
// ------------------------------------------------------------
var map = L.map('map').setView([69.4267, -88.5938], 3);

var street = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: "© OpenStreetMap contributors"
}).addTo(map);

// ------------------------------------------------------------
// UNIVERSAL HOVER + TOOLTIP HANDLER
// ------------------------------------------------------------
function attachEvents(feature, layer) {

  // Save original style for restoring hover-out
  layer.defaultStyle = {
    color: layer.options.color,
    weight: layer.options.weight,
    fillOpacity: layer.options.fillOpacity
  };

  // Tooltip showing attributes
  let tooltipContent = "";
  Object.entries(feature.properties).forEach(([k, v]) => {
    tooltipContent += `<strong>${k}</strong>: ${v}<br>`;
  });
  layer.bindTooltip(tooltipContent, { sticky: true });

  // Hover effects
  layer.on({
    mouseover: e => {
      e.target.setStyle({
        color: "yellow",
        weight: 3,
        fillOpacity: 0.6
      });
    },
    mouseout: e => {
      e.target.setStyle(e.target.defaultStyle);
    }
  });
}

// ------------------------------------------------------------
// FUNCTION TO LOAD ONE OR MULTIPLE GEOJSON FILES INTO ONE LAYER
// ------------------------------------------------------------
function loadGeoJSONFiles(fileList, color) {
  let layer = L.geoJSON(null, {
    style: {
      color: color,
      weight: 2,
      fillOpacity: 0.3
    },
    onEachFeature: attachEvents
  });

  fileList.forEach(url => {
    fetch(url)
      .then(res => res.json())
      .then(data => layer.addData(data))
      .catch(err => console.error("GeoJSON load error:", url, err));
  });

  return layer;
}

// ------------------------------------------------------------
// ALL LAYERS (clean, consistent structure)
// ------------------------------------------------------------
const layers = {
  "Manitoba": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/Manitoba_Parks_Filtered_final.geojson"
  ], "purple"),

  "Saskatchewan": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/Saskatchewan_Parks_Modified_renamed_final_last.geojson"
  ], "orange"),

  "Quebec": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/QC_1real_final_last.geojson",
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/QC_2real_final_last.geojson"
  ], "blue"),

  "Prince Edward Island": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/pei_prov_parks_finaL_last.geojson"
  ], "red"),

  "Ontario": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/wilderness_areas_final_last.geojson",
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/PROV_PARK_REGULATED_final_last_last_part1.geojson",
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/PROV_PARK_REGULATED_final_last_last_part2.geojson",
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/PROV_PARK_REGULATED_final_last_last_part3.geojson",
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/protected_areas_far_north_final.geojson"
  ], "green"),

  "Nova Scotia": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/ns_provincial_parks_final.geojson"
  ], "pink"),

  "New Brunswick": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/nb_prov_parks_final.geojson"
  ], "yellow"),

  "National Parks": loadGeoJSONFiles([
    "https://raw.githubusercontent.com/sreymon/464WEBSITE1/refs/heads/main/final_merged_with_comments_gdf.geojson"
  ], "brown")
};

// ------------------------------------------------------------
// ADD FIRST LAYER BY DEFAULT
// ------------------------------------------------------------
layers["Manitoba"].addTo(map);

// ------------------------------------------------------------
// LAYER CONTROL
// ------------------------------------------------------------
L.control.layers({ "Street": street }, layers, { collapsed: false }).addTo(map);

// ------------------------------------------------------------
// CLICK POPUP
// ------------------------------------------------------------
map.on("click", function (e) {
  L.popup()
    .setLatLng(e.latlng)
    .setContent(`You clicked at:<br>${e.latlng.lat.toFixed(4)}, ${e.latlng.lng.toFixed(4)}`)
    .openOn(map);
});

</script>
</body>
</html>
